# Lorenz / Tunny

## How Lorenz Works

The Lorenz machine essentially works as a Vernam cipher with a pseudo-random key.

The encryption key is generated by two banks of rotors, the 'chi' bank and the 'psi' bank, each with 150 and 290 pins respectively that can be changed from a '1' to a '0', with each bank consitisting of 5 rotors. The key is made by taking the 'active' bit of each rotor in each rotor bank, and taking a bitwise XOR operation on each of these 5-bit keys. This key is then used to encrypt/decrypt a given letter.

The 'chi' bank advances one every time a key is pressed, similar to the enigma rotors, however the 'psi' bank rotates occasionally. This is to do with a third rotor bank, called the 'mu' bank, or motor bank, which consists of 2 rotors, with 37 and 61 pins respectively. The first 'mu' rotor rotates every time a key is pressed, and the second only rotates if the new active bit of the first rotor is a '1'. The 'psi' bank will only advance if the active bit of the second 'mu' rotor is a '1'.

Because of this, decrypting is as easy as encrypting the ciphertext with key that was used to encrypt it initially, similar to the vernam cipher itself.



## How to use the Lorenz implementation

To run this implementation in a shell like manner make sure that "chi_rotors.json", "psi_rotors.json", "mu_rotors.json", "rotor_modules.py", and "main.py" are in the same directory and then run "main.py". This will run it as a shell.

The purpose of each included file is as follows:

  - *chi_rotors.json*: this encodes every pin, or 'cam', for every chi rotor
  - *psi_rotors.json*: as above, but for psi
  - *mu_rotors.json*: as above, but for mu
  - *randomise_rotors.py*: randomises all cams for every rotor and rewrites each rotor file
  - *letter_lookup.json*: a lookup table for letters to 5 bit binary
  - *rotor_modules.py*: this is a module that contains every rotor class utilised
  - *main.py*: this is the main file that allows the lorenz to be used in a shell environment



## Rotor settings input

Rotor settings should be input as such:

To set the chi rotors to [1, 2, 3, 4, 5], mu rotors to [6, 7], and psi rotors to [8, 9, 10, 11, 12], you would enter:

	[1, 2, 3, 4, 5] | [6, 7] | [8, 9, 10, 11, 12] 



## Text input / Reading text output

In the input/output of the machine, a physical space ' ' is purely aesthetic to make things easier to read. Instead of using these types of space, Lorenz uses a '9' to represent them. Most common interpretations are:
  - **9**: space
  - **8**: -
  - **5**: +
  - **4**: LF
  - **3**: CR
  - **/**: null